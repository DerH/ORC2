function G = linearize_gyro(p1,p2,p3)
% LPVplant(w1,q2,q3)
%
% Linearizes the Control Moment Gyroscope at frozen operating points

np1 = numel(p1);
np2 = numel(p2);
np3 = numel(p3);

G = ss(zeros(2,2,np1,np2,np3));
for ii = 1:np1
    for jj = 1:np2
        for ll = 1:np3
            G(:,:,ii,jj,ll) = LPVplant(p1(ii), p2(jj), p3(ll));
        end
    end
end

function G = LPVplant(w1,q2,q3)
Ka = 0.0670;
Ib = 0.0119;
Jb = 0.0178;
Kb = 0.0297;
Ic = 0.0092;
Jc = 0.0230;
Kc = 0.0220;
Id = 0.0148;
Jd = 0.0273;
%K_D =I_D

Fv1 = 1.8700e-4;
Fv2 = 0.0118;
Fv3 = 0.0027;
Fv4 = 0.0027;

h1 = -(2*Fv2*Id*Id + 2*Fv2*Ib*Id + 2*Fv2*Ic*Id + 4*Fv2*Ib*Jb + 2*Fv2*Ib*Jc + 4*Fv2*Ic*Jb + 2*Fv2*Ic*Jc + 6*Fv2*Id*Jb + 6*Fv2*Id*Jc + 2*Fv2*Ib*Kc + 4*Fv2*Id*Ka + 2*Fv2*Jb*Jc + 2*Fv2*Ic*Kc + 2*Fv2*Id*Kb + 2*Fv2*Id*Kc + 8*Fv2*Jb*Ka + 4*Fv2*Jb*Kb + 4*Fv2*Jc*Ka + 2*Fv2*Jb*Kc + 2*Fv2*Jc*Kb + 4*Fv2*Jc*Kc + 4*Fv2*Ka*Kc + 2*Fv2*Kb*Kc - 2*Fv2*Id*Id*cos(2*q2) - 2*Fv2*Id*Id*cos(2*q3) + Fv2*Id*Id*cos(2*q2 - 2*q3) + Fv2*Id*Id*cos(2*q2 + 2*q3) - 2*Fv2*Ib*Id*cos(2*q2) - 2*Fv2*Ib*Id*cos(2*q3) - 2*Fv2*Ic*Id*cos(2*q2) - 2*Fv2*Ic*Id*cos(2*q3) - 4*Fv2*Ib*Jb*cos(2*q3) + 2*Fv2*Ib*Jc*cos(2*q2) - 2*Fv2*Ib*Jc*cos(2*q3) - 4*Fv2*Ic*Jb*cos(2*q3) + 2*Fv2*Ic*Jc*cos(2*q2) + 2*Fv2*Id*Jb*cos(2*q2) - 2*Fv2*Ic*Jc*cos(2*q3) - 2*Fv2*Id*Jb*cos(2*q3) + 2*Fv2*Id*Jc*cos(2*q2) + 2*Fv2*Id*Jc*cos(2*q3) - 2*Fv2*Ib*Kc*cos(2*q2) - 4*Fv2*Id*Ka*cos(2*q2) - 2*Fv2*Jb*Jc*cos(2*q2) - 2*Fv2*Ib*Kc*cos(2*q3) + 2*Fv2*Jb*Jc*cos(2*q3) - 2*Fv2*Ic*Kc*cos(2*q2) - 2*Fv2*Id*Kb*cos(2*q2) - 2*Fv2*Ic*Kc*cos(2*q3) + 2*Fv2*Id*Kb*cos(2*q3) - 2*Fv2*Id*Kc*cos(2*q2) - 2*Fv2*Id*Kc*cos(2*q3) + 4*Fv2*Jc*Ka*cos(2*q2) + 4*Fv2*Jb*Kb*cos(2*q3) + 2*Fv2*Jb*Kc*cos(2*q2) + 2*Fv2*Jc*Kb*cos(2*q2) + 2*Fv2*Jb*Kc*cos(2*q3) + 2*Fv2*Jc*Kb*cos(2*q3) + 4*Fv2*Jc*Kc*cos(2*q3) - 4*Fv2*Ka*Kc*cos(2*q2) - 2*Fv2*Kb*Kc*cos(2*q2) + 2*Fv2*Kb*Kc*cos(2*q3) + Fv2*Ib*Id*cos(2*q2 - 2*q3) + Fv2*Ib*Id*cos(2*q2 + 2*q3) + Fv2*Ic*Id*cos(2*q2 - 2*q3) + Fv2*Ic*Id*cos(2*q2 + 2*q3) - Fv2*Ib*Jc*cos(2*q2 - 2*q3) - Fv2*Ib*Jc*cos(2*q2 + 2*q3) - Fv2*Ic*Jc*cos(2*q2 - 2*q3) - Fv2*Ic*Jc*cos(2*q2 + 2*q3) + Fv2*Id*Jb*cos(2*q2 - 2*q3) + Fv2*Id*Jb*cos(2*q2 + 2*q3) - Fv2*Id*Jc*cos(2*q2 - 2*q3) - Fv2*Id*Jc*cos(2*q2 + 2*q3) + Fv2*Ib*Kc*cos(2*q2 - 2*q3) + Fv2*Ib*Kc*cos(2*q2 + 2*q3) - Fv2*Jb*Jc*cos(2*q2 - 2*q3) - Fv2*Jb*Jc*cos(2*q2 + 2*q3) + Fv2*Ic*Kc*cos(2*q2 - 2*q3) + Fv2*Ic*Kc*cos(2*q2 + 2*q3) - Fv2*Id*Kb*cos(2*q2 - 2*q3) - Fv2*Id*Kb*cos(2*q2 + 2*q3) + Fv2*Id*Kc*cos(2*q2 - 2*q3) + Fv2*Id*Kc*cos(2*q2 + 2*q3) + Fv2*Jb*Kc*cos(2*q2 - 2*q3) + Fv2*Jb*Kc*cos(2*q2 + 2*q3) + Fv2*Jc*Kb*cos(2*q2 - 2*q3) + Fv2*Jc*Kb*cos(2*q2 + 2*q3) - Fv2*Kb*Kc*cos(2*q2 - 2*q3) - Fv2*Kb*Kc*cos(2*q2 + 2*q3) - 2*Ic*Jb*Jd*w1*sin(q2 - 2*q3) + 2*Ic*Jb*Jd*w1*sin(q2 + 2*q3) - 2*Ic*Jc*Jd*w1*sin(q2 - 2*q3) + 2*Ic*Jc*Jd*w1*sin(q2 + 2*q3) - 2*Id*Jb*Jd*w1*sin(q2 - 2*q3) + 2*Id*Jb*Jd*w1*sin(q2 + 2*q3) - 2*Id*Jc*Jd*w1*sin(q2 - 2*q3) + 2*Id*Jc*Jd*w1*sin(q2 + 2*q3))/(2*Ib*Id*Id + 2*Id*Id*Jb + 4*Id*Id*Jc + 4*Id*Id*Ka + 2*Id*Id*Kb + 2*Ib*Ic*Id + 4*Ib*Ic*Jb + 2*Ib*Ic*Jc + 4*Ib*Id*Jb + 2*Ib*Id*Jc + 2*Ic*Id*Jb + 4*Ic*Id*Jc + 2*Ib*Ic*Kc + 4*Ic*Id*Ka + 2*Ic*Jb*Jc + 2*Ib*Id*Kc + 2*Ic*Id*Kb + 2*Id*Jb*Jc + 8*Ic*Jb*Ka + 4*Ic*Jb*Kb + 4*Ic*Jc*Ka + 8*Id*Jb*Ka + 2*Ic*Jb*Kc + 2*Ic*Jc*Kb + 4*Id*Jb*Kb + 4*Id*Jc*Ka + 4*Ic*Jc*Kc + 2*Id*Jb*Kc + 2*Id*Jc*Kb + 4*Id*Jc*Kc + 4*Ic*Ka*Kc + 2*Ic*Kb*Kc + 4*Id*Ka*Kc + 2*Id*Kb*Kc - 2*Ib*Id*Id*cos(2*q2) - 2*Ib*Id*Id*cos(2*q3) + 2*Id*Id*Jb*cos(2*q2) + 2*Id*Id*Jb*cos(2*q3) + 4*Id*Id*Jc*cos(2*q3) - 4*Id*Id*Ka*cos(2*q2) - 2*Id*Id*Kb*cos(2*q2) + 2*Id*Id*Kb*cos(2*q3) + Ib*Id*Id*cos(2*q2 - 2*q3) + Ib*Id*Id*cos(2*q2 + 2*q3) + Id*Id*Jb*cos(2*q2 - 2*q3) + Id*Id*Jb*cos(2*q2 + 2*q3) - Id*Id*Kb*cos(2*q2 - 2*q3) - Id*Id*Kb*cos(2*q2 + 2*q3) - 2*Ib*Ic*Id*cos(2*q2) - 2*Ib*Ic*Id*cos(2*q3) - 4*Ib*Ic*Jb*cos(2*q3) + 2*Ib*Ic*Jc*cos(2*q2) - 2*Ib*Ic*Jc*cos(2*q3) - 4*Ib*Id*Jb*cos(2*q3) + 2*Ib*Id*Jc*cos(2*q2) + 2*Ic*Id*Jb*cos(2*q2) - 2*Ib*Id*Jc*cos(2*q3) + 2*Ic*Id*Jb*cos(2*q3) + 4*Ic*Id*Jc*cos(2*q3) - 2*Ib*Ic*Kc*cos(2*q2) - 4*Ic*Id*Ka*cos(2*q2) - 2*Ic*Jb*Jc*cos(2*q2) - 2*Ib*Ic*Kc*cos(2*q3) + 2*Ic*Jb*Jc*cos(2*q3) - 2*Ib*Id*Kc*cos(2*q2) - 2*Ic*Id*Kb*cos(2*q2) - 2*Id*Jb*Jc*cos(2*q2) - 2*Ib*Id*Kc*cos(2*q3) + 2*Ic*Id*Kb*cos(2*q3) + 2*Id*Jb*Jc*cos(2*q3) + 4*Ic*Jc*Ka*cos(2*q2) + 4*Ic*Jb*Kb*cos(2*q3) + 2*Ic*Jb*Kc*cos(2*q2) + 2*Ic*Jc*Kb*cos(2*q2) + 4*Id*Jc*Ka*cos(2*q2) + 2*Ic*Jb*Kc*cos(2*q3) + 2*Ic*Jc*Kb*cos(2*q3) + 4*Id*Jb*Kb*cos(2*q3) + 2*Id*Jb*Kc*cos(2*q2) + 2*Id*Jc*Kb*cos(2*q2) + 4*Ic*Jc*Kc*cos(2*q3) + 2*Id*Jb*Kc*cos(2*q3) + 2*Id*Jc*Kb*cos(2*q3) + 4*Id*Jc*Kc*cos(2*q3) - 4*Ic*Ka*Kc*cos(2*q2) - 2*Ic*Kb*Kc*cos(2*q2) - 4*Id*Ka*Kc*cos(2*q2) + 2*Ic*Kb*Kc*cos(2*q3) - 2*Id*Kb*Kc*cos(2*q2) + 2*Id*Kb*Kc*cos(2*q3) + Ib*Ic*Id*cos(2*q2 - 2*q3) + Ib*Ic*Id*cos(2*q2 + 2*q3) - Ib*Ic*Jc*cos(2*q2 - 2*q3) - Ib*Ic*Jc*cos(2*q2 + 2*q3) - Ib*Id*Jc*cos(2*q2 - 2*q3) - Ib*Id*Jc*cos(2*q2 + 2*q3) + Ic*Id*Jb*cos(2*q2 - 2*q3) + Ic*Id*Jb*cos(2*q2 + 2*q3) + Ib*Ic*Kc*cos(2*q2 - 2*q3) + Ib*Ic*Kc*cos(2*q2 + 2*q3) - Ic*Jb*Jc*cos(2*q2 - 2*q3) - Ic*Jb*Jc*cos(2*q2 + 2*q3) + Ib*Id*Kc*cos(2*q2 - 2*q3) + Ib*Id*Kc*cos(2*q2 + 2*q3) - Ic*Id*Kb*cos(2*q2 - 2*q3) - Ic*Id*Kb*cos(2*q2 + 2*q3) - Id*Jb*Jc*cos(2*q2 - 2*q3) - Id*Jb*Jc*cos(2*q2 + 2*q3) + Ic*Jb*Kc*cos(2*q2 - 2*q3) + Ic*Jb*Kc*cos(2*q2 + 2*q3) + Ic*Jc*Kb*cos(2*q2 - 2*q3) + Ic*Jc*Kb*cos(2*q2 + 2*q3) + Id*Jb*Kc*cos(2*q2 - 2*q3) + Id*Jb*Kc*cos(2*q2 + 2*q3) + Id*Jc*Kb*cos(2*q2 - 2*q3) + Id*Jc*Kb*cos(2*q2 + 2*q3) - Ic*Kb*Kc*cos(2*q2 - 2*q3) - Ic*Kb*Kc*cos(2*q2 + 2*q3) - Id*Kb*Kc*cos(2*q2 - 2*q3) - Id*Kb*Kc*cos(2*q2 + 2*q3));
h2 = -(2*Fv3*Id*Id*cos(2*q2 - 2*q3) - 2*Fv3*Id*Id*cos(2*q2 + 2*q3) + 2*Fv3*Ic*Id*cos(2*q2 - 2*q3) - 2*Fv3*Ic*Id*cos(2*q2 + 2*q3) - 2*Fv3*Ic*Jc*cos(2*q2 - 2*q3) + 2*Fv3*Ic*Jc*cos(2*q2 + 2*q3) - 2*Fv3*Id*Jc*cos(2*q2 - 2*q3) + 2*Fv3*Id*Jc*cos(2*q2 + 2*q3) + 2*Fv3*Ic*Kc*cos(2*q2 - 2*q3) - 2*Fv3*Ic*Kc*cos(2*q2 + 2*q3) + 2*Fv3*Id*Kc*cos(2*q2 - 2*q3) - 2*Fv3*Id*Kc*cos(2*q2 + 2*q3) + Ib*Id*Jd*w1*sin(3*q2 - 2*q3) + Ib*Id*Jd*w1*sin(3*q2 + 2*q3) - Ib*Jc*Jd*w1*sin(3*q2 - 2*q3) - Ib*Jc*Jd*w1*sin(3*q2 + 2*q3) + Id*Jb*Jd*w1*sin(3*q2 - 2*q3) + Id*Jb*Jd*w1*sin(3*q2 + 2*q3) + Ib*Jd*Kc*w1*sin(3*q2 - 2*q3) + Ib*Jd*Kc*w1*sin(3*q2 + 2*q3) - Jb*Jc*Jd*w1*sin(3*q2 - 2*q3) - Jb*Jc*Jd*w1*sin(3*q2 + 2*q3) - Id*Jd*Kb*w1*sin(3*q2 - 2*q3) - Id*Jd*Kb*w1*sin(3*q2 + 2*q3) + Jb*Jd*Kc*w1*sin(3*q2 - 2*q3) + Jb*Jd*Kc*w1*sin(3*q2 + 2*q3) + Jc*Jd*Kb*w1*sin(3*q2 - 2*q3) + Jc*Jd*Kb*w1*sin(3*q2 + 2*q3) - Jd*Kb*Kc*w1*sin(3*q2 - 2*q3) - Jd*Kb*Kc*w1*sin(3*q2 + 2*q3) + 8*Ib*Id*Jd*w1*sin(q2) + 8*Ib*Jb*Jd*w1*sin(q2) + 8*Id*Jc*Jd*w1*sin(q2) + 8*Ib*Jd*Kc*w1*sin(q2) + 16*Id*Jd*Ka*w1*sin(q2) + 8*Jb*Jc*Jd*w1*sin(q2) + 8*Id*Jd*Kb*w1*sin(q2) + 16*Jb*Jd*Ka*w1*sin(q2) + 8*Jb*Jd*Kb*w1*sin(q2) + 8*Jc*Jd*Kc*w1*sin(q2) + 16*Jd*Ka*Kc*w1*sin(q2) + 8*Jd*Kb*Kc*w1*sin(q2) - 3*Ib*Id*Jd*w1*sin(q2 - 2*q3) - 3*Ib*Id*Jd*w1*sin(q2 + 2*q3) - 4*Ib*Jb*Jd*w1*sin(q2 - 2*q3) - 4*Ib*Jb*Jd*w1*sin(q2 + 2*q3) - Ib*Jc*Jd*w1*sin(q2 - 2*q3) - Ib*Jc*Jd*w1*sin(q2 + 2*q3) + Id*Jb*Jd*w1*sin(q2 - 2*q3) + Id*Jb*Jd*w1*sin(q2 + 2*q3) + 4*Id*Jc*Jd*w1*sin(q2 - 2*q3) + 4*Id*Jc*Jd*w1*sin(q2 + 2*q3) - 3*Ib*Jd*Kc*w1*sin(q2 - 2*q3) - 3*Ib*Jd*Kc*w1*sin(q2 + 2*q3) + 3*Jb*Jc*Jd*w1*sin(q2 - 2*q3) + 3*Jb*Jc*Jd*w1*sin(q2 + 2*q3) + 3*Id*Jd*Kb*w1*sin(q2 - 2*q3) + 3*Id*Jd*Kb*w1*sin(q2 + 2*q3) + 4*Jb*Jd*Kb*w1*sin(q2 - 2*q3) + 4*Jb*Jd*Kb*w1*sin(q2 + 2*q3) + Jb*Jd*Kc*w1*sin(q2 - 2*q3) + Jb*Jd*Kc*w1*sin(q2 + 2*q3) + Jc*Jd*Kb*w1*sin(q2 - 2*q3) + Jc*Jd*Kb*w1*sin(q2 + 2*q3) + 4*Jc*Jd*Kc*w1*sin(q2 - 2*q3) + 4*Jc*Jd*Kc*w1*sin(q2 + 2*q3) + 3*Jd*Kb*Kc*w1*sin(q2 - 2*q3) + 3*Jd*Kb*Kc*w1*sin(q2 + 2*q3) - 8*Ib*Id*Jd*w1*cos(q2)*cos(q2)*sin(q2) + 8*Ib*Jc*Jd*w1*cos(q2)*cos(q2)*sin(q2) + 8*Id*Jb*Jd*w1*cos(q2)*cos(q2)*sin(q2) - 8*Ib*Jd*Kc*w1*cos(q2)*cos(q2)*sin(q2) - 16*Id*Jd*Ka*w1*cos(q2)*cos(q2)*sin(q2) - 8*Jb*Jc*Jd*w1*cos(q2)*cos(q2)*sin(q2) - 8*Id*Jd*Kb*w1*cos(q2)*cos(q2)*sin(q2) + 16*Jc*Jd*Ka*w1*cos(q2)*cos(q2)*sin(q2) + 8*Jb*Jd*Kc*w1*cos(q2)*cos(q2)*sin(q2) + 8*Jc*Jd*Kb*w1*cos(q2)*cos(q2)*sin(q2) - 16*Jd*Ka*Kc*w1*cos(q2)*cos(q2)*sin(q2) - 8*Jd*Kb*Kc*w1*cos(q2)*cos(q2)*sin(q2))/(8*Ib*Id*Id + 8*Id*Id*Jc + 16*Id*Id*Ka + 8*Id*Id*Kb + 8*Ib*Ic*Id + 8*Ib*Ic*Jb + 8*Ib*Id*Jb + 8*Ic*Id*Jc + 8*Ib*Ic*Kc + 16*Ic*Id*Ka + 8*Ic*Jb*Jc + 8*Ib*Id*Kc + 8*Ic*Id*Kb + 8*Id*Jb*Jc + 16*Ic*Jb*Ka + 8*Ic*Jb*Kb + 16*Id*Jb*Ka + 8*Id*Jb*Kb + 8*Ic*Jc*Kc + 8*Id*Jc*Kc + 16*Ic*Ka*Kc + 8*Ic*Kb*Kc + 16*Id*Ka*Kc + 8*Id*Kb*Kc - 4*Ib*Id*Id*cos(2*q3) - 8*Ib*Id*Id*cos(q2)*cos(q2) + 4*Id*Id*Jb*cos(2*q3) + 8*Id*Id*Jc*cos(2*q3) + 8*Id*Id*Jb*cos(q2)*cos(q2) + 4*Id*Id*Kb*cos(2*q3) - 16*Id*Id*Ka*cos(q2)*cos(q2) - 8*Id*Id*Kb*cos(q2)*cos(q2) + 2*Ib*Id*Id*cos(2*q2 - 2*q3) + 2*Ib*Id*Id*cos(2*q2 + 2*q3) + 2*Id*Id*Jb*cos(2*q2 - 2*q3) + 2*Id*Id*Jb*cos(2*q2 + 2*q3) - 2*Id*Id*Kb*cos(2*q2 - 2*q3) - 2*Id*Id*Kb*cos(2*q2 + 2*q3) - 4*Ib*Ic*Id*cos(2*q3) - 8*Ib*Ic*Id*cos(q2)*cos(q2) - 8*Ib*Ic*Jb*cos(2*q3) - 4*Ib*Ic*Jc*cos(2*q3) - 8*Ib*Id*Jb*cos(2*q3) - 4*Ib*Id*Jc*cos(2*q3) + 4*Ic*Id*Jb*cos(2*q3) + 8*Ic*Id*Jc*cos(2*q3) + 8*Ib*Ic*Jc*cos(q2)*cos(q2) + 8*Ib*Id*Jc*cos(q2)*cos(q2) + 8*Ic*Id*Jb*cos(q2)*cos(q2) - 4*Ib*Ic*Kc*cos(2*q3) + 4*Ic*Jb*Jc*cos(2*q3) - 4*Ib*Id*Kc*cos(2*q3) + 4*Ic*Id*Kb*cos(2*q3) + 4*Id*Jb*Jc*cos(2*q3) - 8*Ib*Ic*Kc*cos(q2)*cos(q2) - 16*Ic*Id*Ka*cos(q2)*cos(q2) - 8*Ic*Jb*Jc*cos(q2)*cos(q2) - 8*Ib*Id*Kc*cos(q2)*cos(q2) - 8*Ic*Id*Kb*cos(q2)*cos(q2) - 8*Id*Jb*Jc*cos(q2)*cos(q2) + 8*Ic*Jb*Kb*cos(2*q3) + 4*Ic*Jb*Kc*cos(2*q3) + 4*Ic*Jc*Kb*cos(2*q3) + 8*Id*Jb*Kb*cos(2*q3) + 8*Ic*Jc*Kc*cos(2*q3) + 4*Id*Jb*Kc*cos(2*q3) + 4*Id*Jc*Kb*cos(2*q3) + 16*Ic*Jc*Ka*cos(q2)*cos(q2) + 8*Id*Jc*Kc*cos(2*q3) + 8*Ic*Jb*Kc*cos(q2)*cos(q2) + 8*Ic*Jc*Kb*cos(q2)*cos(q2) + 16*Id*Jc*Ka*cos(q2)*cos(q2) + 8*Id*Jb*Kc*cos(q2)*cos(q2) + 8*Id*Jc*Kb*cos(q2)*cos(q2) + 4*Ic*Kb*Kc*cos(2*q3) + 4*Id*Kb*Kc*cos(2*q3) - 16*Ic*Ka*Kc*cos(q2)*cos(q2) - 8*Ic*Kb*Kc*cos(q2)*cos(q2) - 16*Id*Ka*Kc*cos(q2)*cos(q2) - 8*Id*Kb*Kc*cos(q2)*cos(q2) + 2*Ib*Ic*Id*cos(2*q2 - 2*q3) + 2*Ib*Ic*Id*cos(2*q2 + 2*q3) - 2*Ib*Ic*Jc*cos(2*q2 - 2*q3) - 2*Ib*Ic*Jc*cos(2*q2 + 2*q3) - 2*Ib*Id*Jc*cos(2*q2 - 2*q3) - 2*Ib*Id*Jc*cos(2*q2 + 2*q3) + 2*Ic*Id*Jb*cos(2*q2 - 2*q3) + 2*Ic*Id*Jb*cos(2*q2 + 2*q3) + 2*Ib*Ic*Kc*cos(2*q2 - 2*q3) + 2*Ib*Ic*Kc*cos(2*q2 + 2*q3) - 2*Ic*Jb*Jc*cos(2*q2 - 2*q3) - 2*Ic*Jb*Jc*cos(2*q2 + 2*q3) + 2*Ib*Id*Kc*cos(2*q2 - 2*q3) + 2*Ib*Id*Kc*cos(2*q2 + 2*q3) - 2*Ic*Id*Kb*cos(2*q2 - 2*q3) - 2*Ic*Id*Kb*cos(2*q2 + 2*q3) - 2*Id*Jb*Jc*cos(2*q2 - 2*q3) - 2*Id*Jb*Jc*cos(2*q2 + 2*q3) + 2*Ic*Jb*Kc*cos(2*q2 - 2*q3) + 2*Ic*Jb*Kc*cos(2*q2 + 2*q3) + 2*Ic*Jc*Kb*cos(2*q2 - 2*q3) + 2*Ic*Jc*Kb*cos(2*q2 + 2*q3) + 2*Id*Jb*Kc*cos(2*q2 - 2*q3) + 2*Id*Jb*Kc*cos(2*q2 + 2*q3) + 2*Id*Jc*Kb*cos(2*q2 - 2*q3) + 2*Id*Jc*Kb*cos(2*q2 + 2*q3) - 2*Ic*Kb*Kc*cos(2*q2 - 2*q3) - 2*Ic*Kb*Kc*cos(2*q2 + 2*q3) - 2*Id*Kb*Kc*cos(2*q2 - 2*q3) - 2*Id*Kb*Kc*cos(2*q2 + 2*q3));
h3 = (Fv4*Id*Id*cos(q2)*cos(q2)*sin(q3) - Fv4*Ic*Id*sin(q3) - Fv4*Ic*Jb*sin(q3) - Fv4*Id*Jb*sin(q3) - Fv4*Ic*Kc*sin(q3) - Fv4*Id*Kc*sin(q3) - Fv4*Id*Id*sin(q3) + Fv4*Ic*Id*cos(q2)*cos(q2)*sin(q3) - Fv4*Ic*Jc*cos(q2)*cos(q2)*sin(q3) - Fv4*Id*Jc*cos(q2)*cos(q2)*sin(q3) + Fv4*Ic*Kc*cos(q2)*cos(q2)*sin(q3) + Fv4*Id*Kc*cos(q2)*cos(q2)*sin(q3) + Ib*Id*Jd*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Ib*Jc*Jd*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Id*Jb*Jd*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Ib*Jd*Kc*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Jb*Jc*Jd*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Id*Jd*Kb*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Jb*Jd*Kc*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Jc*Jd*Kb*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Jd*Kb*Kc*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Ib*Id*Jd*w1*cos(q2)*cos(q3) + Ib*Jb*Jd*w1*cos(q2)*cos(q3) + Ic*Jb*Jd*w1*cos(q2)*cos(q3) + Ic*Jc*Jd*w1*cos(q2)*cos(q3) + Id*Jb*Jd*w1*cos(q2)*cos(q3) + Id*Jc*Jd*w1*cos(q2)*cos(q3) + Ib*Jd*Kc*w1*cos(q2)*cos(q3) + Id*Jd*Ka*w1*cos(q2)*cos(q3) + Jb*Jd*Ka*w1*cos(q2)*cos(q3) + Jd*Ka*Kc*w1*cos(q2)*cos(q3) - Ib*Id*Jd*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Ib*Id*Jd*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3) - Ib*Jb*Jd*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Ib*Jc*Jd*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3) - Ic*Jb*Jd*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Ic*Jc*Jd*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Id*Jb*Jd*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Ib*Jd*Kc*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Ib*Jd*Kc*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3) - Id*Jd*Ka*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3) + Jb*Jc*Jd*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Id*Jd*Kb*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Jb*Jd*Kb*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) + Jc*Jd*Ka*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3) + Jc*Jd*Kc*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3) - Jd*Ka*Kc*w1*cos(q2)*cos(q2)*cos(q2)*cos(q3) + Jd*Kb*Kc*w1*cos(q2)*cos(q3)*cos(q3)*cos(q3))/(Ib*Id*Id + Id*Id*Ka + Ib*Ic*Id + Ib*Ic*Jb + Ib*Id*Jb + Ib*Ic*Kc + Ic*Id*Ka + Ib*Id*Kc + Ic*Jb*Ka + Id*Jb*Ka + Ic*Ka*Kc + Id*Ka*Kc - Ib*Id*Id*cos(q2)*cos(q2) - Ib*Id*Id*cos(q3)*cos(q3) + Id*Id*Jc*cos(q3)*cos(q3) - Id*Id*Ka*cos(q2)*cos(q2) + Id*Id*Kb*cos(q3)*cos(q3) - Ib*Ic*Id*cos(q2)*cos(q2) - Ib*Ic*Id*cos(q3)*cos(q3) - Ib*Ic*Jb*cos(q3)*cos(q3) + Ib*Ic*Jc*cos(q2)*cos(q2) - Ib*Id*Jb*cos(q3)*cos(q3) + Ib*Id*Jc*cos(q2)*cos(q2) + Ic*Id*Jc*cos(q3)*cos(q3) - Ib*Ic*Kc*cos(q2)*cos(q2) - Ic*Id*Ka*cos(q2)*cos(q2) - Ib*Ic*Kc*cos(q3)*cos(q3) + Ic*Jb*Jc*cos(q3)*cos(q3) - Ib*Id*Kc*cos(q2)*cos(q2) - Ib*Id*Kc*cos(q3)*cos(q3) + Ic*Id*Kb*cos(q3)*cos(q3) + Id*Jb*Jc*cos(q3)*cos(q3) + Ic*Jc*Ka*cos(q2)*cos(q2) + Ic*Jb*Kb*cos(q3)*cos(q3) + Id*Jc*Ka*cos(q2)*cos(q2) + Id*Jb*Kb*cos(q3)*cos(q3) + Ic*Jc*Kc*cos(q3)*cos(q3) + Id*Jc*Kc*cos(q3)*cos(q3) - Ic*Ka*Kc*cos(q2)*cos(q2) - Id*Ka*Kc*cos(q2)*cos(q2) + Ic*Kb*Kc*cos(q3)*cos(q3) + Id*Kb*Kc*cos(q3)*cos(q3) + Ib*Id*Id*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Id*Id*Jb*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Id*Id*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ib*Ic*Id*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Ib*Ic*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Ib*Id*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ic*Id*Jb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ib*Ic*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Ic*Jb*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ib*Id*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Ic*Id*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Id*Jb*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ic*Jb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ic*Jc*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Id*Jb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Id*Jc*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Ic*Kb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Id*Kb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3));
h4 = (Fv2*Id*cos(2*q2 + 2*q3) - Fv2*Id*cos(2*q2 - 2*q3) + Fv2*Jc*cos(2*q2 - 2*q3) - Fv2*Jc*cos(2*q2 + 2*q3) - Fv2*Kc*cos(2*q2 - 2*q3) + Fv2*Kc*cos(2*q2 + 2*q3) + 4*Ib*Jd*w1*sin(q2) + 4*Jc*Jd*w1*sin(q2) + 8*Jd*Ka*w1*sin(q2) + 4*Jd*Kb*w1*sin(q2) - 2*Ib*Jd*w1*sin(q2 - 2*q3) - 2*Ib*Jd*w1*sin(q2 + 2*q3) + 2*Jc*Jd*w1*sin(q2 - 2*q3) + 2*Jc*Jd*w1*sin(q2 + 2*q3) + 2*Jd*Kb*w1*sin(q2 - 2*q3) + 2*Jd*Kb*w1*sin(q2 + 2*q3))/(4*Ib*Id + 4*Ib*Jb + 4*Id*Jc + 4*Ib*Kc + 8*Id*Ka + 4*Jb*Jc + 4*Id*Kb + 8*Jb*Ka + 4*Jb*Kb + 4*Jc*Kc + 8*Ka*Kc + 4*Kb*Kc - 2*Ib*Id*cos(2*q3) - 4*Ib*Id*cos(q2)*cos(q2) - 4*Ib*Jb*cos(2*q3) - 2*Ib*Jc*cos(2*q3) + 2*Id*Jb*cos(2*q3) + 4*Id*Jc*cos(2*q3) + 4*Ib*Jc*cos(q2)*cos(q2) + 4*Id*Jb*cos(q2)*cos(q2) - 2*Ib*Kc*cos(2*q3) + 2*Jb*Jc*cos(2*q3) + 2*Id*Kb*cos(2*q3) - 4*Ib*Kc*cos(q2)*cos(q2) - 8*Id*Ka*cos(q2)*cos(q2) - 4*Jb*Jc*cos(q2)*cos(q2) - 4*Id*Kb*cos(q2)*cos(q2) + 4*Jb*Kb*cos(2*q3) + 2*Jb*Kc*cos(2*q3) + 2*Jc*Kb*cos(2*q3) + 4*Jc*Kc*cos(2*q3) + 8*Jc*Ka*cos(q2)*cos(q2) + 4*Jb*Kc*cos(q2)*cos(q2) + 4*Jc*Kb*cos(q2)*cos(q2) + 2*Kb*Kc*cos(2*q3) - 8*Ka*Kc*cos(q2)*cos(q2) - 4*Kb*Kc*cos(q2)*cos(q2) + Ib*Id*cos(2*q2 - 2*q3) + Ib*Id*cos(2*q2 + 2*q3) - Ib*Jc*cos(2*q2 - 2*q3) - Ib*Jc*cos(2*q2 + 2*q3) + Id*Jb*cos(2*q2 - 2*q3) + Id*Jb*cos(2*q2 + 2*q3) + Ib*Kc*cos(2*q2 - 2*q3) + Ib*Kc*cos(2*q2 + 2*q3) - Jb*Jc*cos(2*q2 - 2*q3) - Jb*Jc*cos(2*q2 + 2*q3) - Id*Kb*cos(2*q2 - 2*q3) - Id*Kb*cos(2*q2 + 2*q3) + Jb*Kc*cos(2*q2 - 2*q3) + Jb*Kc*cos(2*q2 + 2*q3) + Jc*Kb*cos(2*q2 - 2*q3) + Jc*Kb*cos(2*q2 + 2*q3) - Kb*Kc*cos(2*q2 - 2*q3) - Kb*Kc*cos(2*q2 + 2*q3));
h5 = -(Fv3*(Ib/2 + Id/4 + Jc/4 + Ka + Kb/2 + Kc/4 + (Id*cos(2*q2 - 2*q3))/8 + (Id*cos(2*q2 + 2*q3))/8 - (Jc*cos(2*q2 - 2*q3))/8 - (Jc*cos(2*q2 + 2*q3))/8 + (Kc*cos(2*q2 - 2*q3))/8 + (Kc*cos(2*q2 + 2*q3))/8 - (Ib*cos(2*q3))/2 + (Id*cos(2*q2))/4 + (Id*cos(2*q3))/4 - (Jc*cos(2*q2))/4 + (Jc*cos(2*q3))/4 + (Kb*cos(2*q3))/2 + (Kc*cos(2*q2))/4 + (Kc*cos(2*q3))/4))/((Ib*Id)/4 + (Ib*Jb)/2 + (Ib*Jc)/4 + (Id*Jb)/4 + (Id*Jc)/2 + (Ib*Kc)/4 + (Id*Ka)/2 + (Jb*Jc)/4 + (Id*Kb)/4 + Jb*Ka + (Jb*Kb)/2 + (Jc*Ka)/2 + (Jb*Kc)/4 + (Jc*Kb)/4 + (Jc*Kc)/2 + (Ka*Kc)/2 + (Kb*Kc)/4 - (Ib*Id*cos(2*q2))/4 - (Ib*Id*cos(2*q3))/4 - (Ib*Jb*cos(2*q3))/2 + (Ib*Jc*cos(2*q2))/4 - (Ib*Jc*cos(2*q3))/4 + (Id*Jb*cos(2*q2))/4 + (Id*Jb*cos(2*q3))/4 + (Id*Jc*cos(2*q3))/2 - (Ib*Kc*cos(2*q2))/4 - (Id*Ka*cos(2*q2))/2 - (Jb*Jc*cos(2*q2))/4 - (Ib*Kc*cos(2*q3))/4 + (Jb*Jc*cos(2*q3))/4 - (Id*Kb*cos(2*q2))/4 + (Id*Kb*cos(2*q3))/4 + (Jc*Ka*cos(2*q2))/2 + (Jb*Kb*cos(2*q3))/2 + (Jb*Kc*cos(2*q2))/4 + (Jc*Kb*cos(2*q2))/4 + (Jb*Kc*cos(2*q3))/4 + (Jc*Kb*cos(2*q3))/4 + (Jc*Kc*cos(2*q3))/2 - (Ka*Kc*cos(2*q2))/2 - (Kb*Kc*cos(2*q2))/4 + (Kb*Kc*cos(2*q3))/4 + (Ib*Id*cos(2*q2 - 2*q3))/8 + (Ib*Id*cos(2*q2 + 2*q3))/8 - (Ib*Jc*cos(2*q2 - 2*q3))/8 - (Ib*Jc*cos(2*q2 + 2*q3))/8 + (Id*Jb*cos(2*q2 - 2*q3))/8 + (Id*Jb*cos(2*q2 + 2*q3))/8 + (Ib*Kc*cos(2*q2 - 2*q3))/8 + (Ib*Kc*cos(2*q2 + 2*q3))/8 - (Jb*Jc*cos(2*q2 - 2*q3))/8 - (Jb*Jc*cos(2*q2 + 2*q3))/8 - (Id*Kb*cos(2*q2 - 2*q3))/8 - (Id*Kb*cos(2*q2 + 2*q3))/8 + (Jb*Kc*cos(2*q2 - 2*q3))/8 + (Jb*Kc*cos(2*q2 + 2*q3))/8 + (Jc*Kb*cos(2*q2 - 2*q3))/8 + (Jc*Kb*cos(2*q2 + 2*q3))/8 - (Kb*Kc*cos(2*q2 - 2*q3))/8 - (Kb*Kc*cos(2*q2 + 2*q3))/8);
h6 = -(cos(q2)*(Fv4*Id*cos(q3)*sin(q2) - Fv4*Jc*cos(q3)*sin(q2) + Fv4*Kc*cos(q3)*sin(q2)) + Ib*Jd*w1*sin(q2)*sin(q3) + Jd*Ka*w1*sin(q2)*sin(q3) - Ib*Jd*w1*cos(q3)*cos(q3)*sin(q2)*sin(q3) + Jc*Jd*w1*cos(q3)*cos(q3)*sin(q2)*sin(q3) + Jd*Kb*w1*cos(q3)*cos(q3)*sin(q2)*sin(q3))/(Ib*Id + Ib*Jb + Ib*Kc + Id*Ka + Jb*Ka + Ka*Kc - Ib*Id*cos(q2)*cos(q2) - Ib*Id*cos(q3)*cos(q3) - Ib*Jb*cos(q3)*cos(q3) + Ib*Jc*cos(q2)*cos(q2) + Id*Jc*cos(q3)*cos(q3) - Ib*Kc*cos(q2)*cos(q2) - Id*Ka*cos(q2)*cos(q2) - Ib*Kc*cos(q3)*cos(q3) + Jb*Jc*cos(q3)*cos(q3) + Id*Kb*cos(q3)*cos(q3) + Jc*Ka*cos(q2)*cos(q2) + Jb*Kb*cos(q3)*cos(q3) + Jc*Kc*cos(q3)*cos(q3) - Ka*Kc*cos(q2)*cos(q2) + Kb*Kc*cos(q3)*cos(q3) + Ib*Id*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Ib*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Id*Jb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ib*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Jb*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Id*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Jb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Jc*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Kb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3));
h7 = -(2*Fv2*Jc*sin(2*q2 + q3) - 2*Fv2*Id*sin(2*q2 + q3) - 2*Fv2*Kc*sin(2*q2 + q3) + 2*Fv2*Id*sin(2*q2 - q3) - 2*Fv2*Jc*sin(2*q2 - q3) + 2*Fv2*Kc*sin(2*q2 - q3) + 4*Fv2*Id*sin(q3) + 8*Fv2*Jb*sin(q3) + 4*Fv2*Jc*sin(q3) + 4*Fv2*Kc*sin(q3) + 4*Jb*Jd*w1*cos(q2 + q3) + 4*Jc*Jd*w1*cos(q2 + q3) + 4*Jb*Jd*w1*cos(q2 - q3) + 4*Jc*Jd*w1*cos(q2 - q3))/(4*Ib*Id + 8*Ib*Jb + 4*Ib*Jc + 4*Ib*Kc + 4*Id*Ka + 8*Jb*Ka + 4*Jc*Ka + 4*Ka*Kc - 2*Ib*Id*cos(2*q2) - 4*Ib*Id*cos(q3)*cos(q3) + 2*Ib*Jc*cos(2*q2) + 2*Id*Jb*cos(2*q2) - 8*Ib*Jb*cos(q3)*cos(q3) - 4*Ib*Jc*cos(q3)*cos(q3) + 4*Id*Jb*cos(q3)*cos(q3) + 8*Id*Jc*cos(q3)*cos(q3) - 2*Ib*Kc*cos(2*q2) - 4*Id*Ka*cos(2*q2) - 2*Jb*Jc*cos(2*q2) - 2*Id*Kb*cos(2*q2) - 4*Ib*Kc*cos(q3)*cos(q3) + 4*Jb*Jc*cos(q3)*cos(q3) + 4*Id*Kb*cos(q3)*cos(q3) + 4*Jc*Ka*cos(2*q2) + 2*Jb*Kc*cos(2*q2) + 2*Jc*Kb*cos(2*q2) + 8*Jb*Kb*cos(q3)*cos(q3) + 4*Jb*Kc*cos(q3)*cos(q3) + 4*Jc*Kb*cos(q3)*cos(q3) + 8*Jc*Kc*cos(q3)*cos(q3) - 4*Ka*Kc*cos(2*q2) - 2*Kb*Kc*cos(2*q2) + 4*Kb*Kc*cos(q3)*cos(q3) + Ib*Id*cos(2*q2 - 2*q3) + Ib*Id*cos(2*q2 + 2*q3) - Ib*Jc*cos(2*q2 - 2*q3) - Ib*Jc*cos(2*q2 + 2*q3) + Id*Jb*cos(2*q2 - 2*q3) + Id*Jb*cos(2*q2 + 2*q3) + Ib*Kc*cos(2*q2 - 2*q3) + Ib*Kc*cos(2*q2 + 2*q3) - Jb*Jc*cos(2*q2 - 2*q3) - Jb*Jc*cos(2*q2 + 2*q3) - Id*Kb*cos(2*q2 - 2*q3) - Id*Kb*cos(2*q2 + 2*q3) + Jb*Kc*cos(2*q2 - 2*q3) + Jb*Kc*cos(2*q2 + 2*q3) + Jc*Kb*cos(2*q2 - 2*q3) + Jc*Kb*cos(2*q2 + 2*q3) - Kb*Kc*cos(2*q2 - 2*q3) - Kb*Kc*cos(2*q2 + 2*q3));
h8 = -(Fv3*(2*Id*sin(2*q2 - q3) - 2*Jc*sin(2*q2 - q3) + 2*Kc*sin(2*q2 - q3) + 2*Id*sin(2*q2 + q3) - 2*Jc*sin(2*q2 + q3) + 2*Kc*sin(2*q2 + q3)))/(2*Ib*Id + 4*Ib*Jb + 2*Ib*Jc + 2*Id*Jb + 4*Id*Jc + 2*Ib*Kc + 4*Id*Ka + 2*Jb*Jc + 2*Id*Kb + 8*Jb*Ka + 4*Jb*Kb + 4*Jc*Ka + 2*Jb*Kc + 2*Jc*Kb + 4*Jc*Kc + 4*Ka*Kc + 2*Kb*Kc - 2*Ib*Id*cos(2*q2) - 2*Ib*Id*cos(2*q3) - 4*Ib*Jb*cos(2*q3) + 2*Ib*Jc*cos(2*q2) - 2*Ib*Jc*cos(2*q3) + 2*Id*Jb*cos(2*q2) + 2*Id*Jb*cos(2*q3) + 4*Id*Jc*cos(2*q3) - 2*Ib*Kc*cos(2*q2) - 4*Id*Ka*cos(2*q2) - 2*Jb*Jc*cos(2*q2) - 2*Ib*Kc*cos(2*q3) + 2*Jb*Jc*cos(2*q3) - 2*Id*Kb*cos(2*q2) + 2*Id*Kb*cos(2*q3) + 4*Jc*Ka*cos(2*q2) + 4*Jb*Kb*cos(2*q3) + 2*Jb*Kc*cos(2*q2) + 2*Jc*Kb*cos(2*q2) + 2*Jb*Kc*cos(2*q3) + 2*Jc*Kb*cos(2*q3) + 4*Jc*Kc*cos(2*q3) - 4*Ka*Kc*cos(2*q2) - 2*Kb*Kc*cos(2*q2) + 2*Kb*Kc*cos(2*q3) + Ib*Id*cos(2*q2 - 2*q3) + Ib*Id*cos(2*q2 + 2*q3) - Ib*Jc*cos(2*q2 - 2*q3) - Ib*Jc*cos(2*q2 + 2*q3) + Id*Jb*cos(2*q2 - 2*q3) + Id*Jb*cos(2*q2 + 2*q3) + Ib*Kc*cos(2*q2 - 2*q3) + Ib*Kc*cos(2*q2 + 2*q3) - Jb*Jc*cos(2*q2 - 2*q3) - Jb*Jc*cos(2*q2 + 2*q3) - Id*Kb*cos(2*q2 - 2*q3) - Id*Kb*cos(2*q2 + 2*q3) + Jb*Kc*cos(2*q2 - 2*q3) + Jb*Kc*cos(2*q2 + 2*q3) + Jc*Kb*cos(2*q2 - 2*q3) + Jc*Kb*cos(2*q2 + 2*q3) - Kb*Kc*cos(2*q2 - 2*q3) - Kb*Kc*cos(2*q2 + 2*q3));
h9 = -(4*Fv4*Id + 8*Fv4*Jb + 4*Fv4*Jc + 4*Fv4*Kc - 4*Fv4*Id*cos(2*q2) + 4*Fv4*Jc*cos(2*q2) - 4*Fv4*Kc*cos(2*q2) + 2*Jb*Jd*w1*sin(q2 - 2*q3) - 2*Jb*Jd*w1*sin(q2 + 2*q3) + 2*Jc*Jd*w1*sin(q2 - 2*q3) - 2*Jc*Jd*w1*sin(q2 + 2*q3))/(2*Ib*Id + 4*Ib*Jb + 2*Ib*Jc + 2*Id*Jb + 4*Id*Jc + 2*Ib*Kc + 4*Id*Ka + 2*Jb*Jc + 2*Id*Kb + 8*Jb*Ka + 4*Jb*Kb + 4*Jc*Ka + 2*Jb*Kc + 2*Jc*Kb + 4*Jc*Kc + 4*Ka*Kc + 2*Kb*Kc - 2*Ib*Id*cos(2*q2) - 2*Ib*Id*cos(2*q3) - 4*Ib*Jb*cos(2*q3) + 2*Ib*Jc*cos(2*q2) - 2*Ib*Jc*cos(2*q3) + 2*Id*Jb*cos(2*q2) + 2*Id*Jb*cos(2*q3) + 4*Id*Jc*cos(2*q3) - 2*Ib*Kc*cos(2*q2) - 4*Id*Ka*cos(2*q2) - 2*Jb*Jc*cos(2*q2) - 2*Ib*Kc*cos(2*q3) + 2*Jb*Jc*cos(2*q3) - 2*Id*Kb*cos(2*q2) + 2*Id*Kb*cos(2*q3) + 4*Jc*Ka*cos(2*q2) + 4*Jb*Kb*cos(2*q3) + 2*Jb*Kc*cos(2*q2) + 2*Jc*Kb*cos(2*q2) + 2*Jb*Kc*cos(2*q3) + 2*Jc*Kb*cos(2*q3) + 4*Jc*Kc*cos(2*q3) - 4*Ka*Kc*cos(2*q2) - 2*Kb*Kc*cos(2*q2) + 2*Kb*Kc*cos(2*q3) + Ib*Id*cos(2*q2 - 2*q3) + Ib*Id*cos(2*q2 + 2*q3) - Ib*Jc*cos(2*q2 - 2*q3) - Ib*Jc*cos(2*q2 + 2*q3) + Id*Jb*cos(2*q2 - 2*q3) + Id*Jb*cos(2*q2 + 2*q3) + Ib*Kc*cos(2*q2 - 2*q3) + Ib*Kc*cos(2*q2 + 2*q3) - Jb*Jc*cos(2*q2 - 2*q3) - Jb*Jc*cos(2*q2 + 2*q3) - Id*Kb*cos(2*q2 - 2*q3) - Id*Kb*cos(2*q2 + 2*q3) + Jb*Kc*cos(2*q2 - 2*q3) + Jb*Kc*cos(2*q2 + 2*q3) + Jc*Kb*cos(2*q2 - 2*q3) + Jc*Kb*cos(2*q2 + 2*q3) - Kb*Kc*cos(2*q2 - 2*q3) - Kb*Kc*cos(2*q2 + 2*q3));
h10 = -(cos(q3)*(Id*sin(q2)*sin(q3) + Jb*sin(q2)*sin(q3) + Kc*sin(q2)*sin(q3)))/(Ib*Id + Ib*Jb + Ib*Kc + Id*Ka + Jb*Ka + Ka*Kc - Ib*Id*cos(q2)*cos(q2) - Ib*Id*cos(q3)*cos(q3) - Ib*Jb*cos(q3)*cos(q3) + Ib*Jc*cos(q2)*cos(q2) + Id*Jc*cos(q3)*cos(q3) - Ib*Kc*cos(q2)*cos(q2) - Id*Ka*cos(q2)*cos(q2) - Ib*Kc*cos(q3)*cos(q3) + Jb*Jc*cos(q3)*cos(q3) + Id*Kb*cos(q3)*cos(q3) + Jc*Ka*cos(q2)*cos(q2) + Jb*Kb*cos(q3)*cos(q3) + Jc*Kc*cos(q3)*cos(q3) - Ka*Kc*cos(q2)*cos(q2) + Kb*Kc*cos(q3)*cos(q3) + Ib*Id*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Ib*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Id*Jb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ib*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Jb*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Id*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Jb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Jc*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Kb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3));
h11 = ((Id*Id*cos(2*q2 - 2*q3))/8 - (Id*Id*cos(2*q3))/4 - (Id*Id*cos(2*q2))/4 + (Id*Id*cos(2*q2 + 2*q3))/8 + Id*Id/4 + (Ib*Id)/4 + (Ic*Id)/4 + (Ib*Jb)/2 + (Ib*Jc)/4 + (Ic*Jb)/2 + (Ic*Jc)/4 + (3*Id*Jb)/4 + (3*Id*Jc)/4 + (Ib*Kc)/4 + (Id*Ka)/2 + (Jb*Jc)/4 + (Ic*Kc)/4 + (Id*Kb)/4 + (Id*Kc)/4 + Jb*Ka + (Jb*Kb)/2 + (Jc*Ka)/2 + (Jb*Kc)/4 + (Jc*Kb)/4 + (Jc*Kc)/2 + (Ka*Kc)/2 + (Kb*Kc)/4 - (Ib*Id*cos(2*q2))/4 - (Ib*Id*cos(2*q3))/4 - (Ic*Id*cos(2*q2))/4 - (Ic*Id*cos(2*q3))/4 - (Ib*Jb*cos(2*q3))/2 + (Ib*Jc*cos(2*q2))/4 - (Ib*Jc*cos(2*q3))/4 - (Ic*Jb*cos(2*q3))/2 + (Ic*Jc*cos(2*q2))/4 + (Id*Jb*cos(2*q2))/4 - (Ic*Jc*cos(2*q3))/4 - (Id*Jb*cos(2*q3))/4 + (Id*Jc*cos(2*q2))/4 + (Id*Jc*cos(2*q3))/4 - (Ib*Kc*cos(2*q2))/4 - (Id*Ka*cos(2*q2))/2 - (Jb*Jc*cos(2*q2))/4 - (Ib*Kc*cos(2*q3))/4 + (Jb*Jc*cos(2*q3))/4 - (Ic*Kc*cos(2*q2))/4 - (Id*Kb*cos(2*q2))/4 - (Ic*Kc*cos(2*q3))/4 + (Id*Kb*cos(2*q3))/4 - (Id*Kc*cos(2*q2))/4 - (Id*Kc*cos(2*q3))/4 + (Jc*Ka*cos(2*q2))/2 + (Jb*Kb*cos(2*q3))/2 + (Jb*Kc*cos(2*q2))/4 + (Jc*Kb*cos(2*q2))/4 + (Jb*Kc*cos(2*q3))/4 + (Jc*Kb*cos(2*q3))/4 + (Jc*Kc*cos(2*q3))/2 - (Ka*Kc*cos(2*q2))/2 - (Kb*Kc*cos(2*q2))/4 + (Kb*Kc*cos(2*q3))/4 + (Ib*Id*cos(2*q2 - 2*q3))/8 + (Ib*Id*cos(2*q2 + 2*q3))/8 + (Ic*Id*cos(2*q2 - 2*q3))/8 + (Ic*Id*cos(2*q2 + 2*q3))/8 - (Ib*Jc*cos(2*q2 - 2*q3))/8 - (Ib*Jc*cos(2*q2 + 2*q3))/8 - (Ic*Jc*cos(2*q2 - 2*q3))/8 - (Ic*Jc*cos(2*q2 + 2*q3))/8 + (Id*Jb*cos(2*q2 - 2*q3))/8 + (Id*Jb*cos(2*q2 + 2*q3))/8 - (Id*Jc*cos(2*q2 - 2*q3))/8 - (Id*Jc*cos(2*q2 + 2*q3))/8 + (Ib*Kc*cos(2*q2 - 2*q3))/8 + (Ib*Kc*cos(2*q2 + 2*q3))/8 - (Jb*Jc*cos(2*q2 - 2*q3))/8 - (Jb*Jc*cos(2*q2 + 2*q3))/8 + (Ic*Kc*cos(2*q2 - 2*q3))/8 + (Ic*Kc*cos(2*q2 + 2*q3))/8 - (Id*Kb*cos(2*q2 - 2*q3))/8 - (Id*Kb*cos(2*q2 + 2*q3))/8 + (Id*Kc*cos(2*q2 - 2*q3))/8 + (Id*Kc*cos(2*q2 + 2*q3))/8 + (Jb*Kc*cos(2*q2 - 2*q3))/8 + (Jb*Kc*cos(2*q2 + 2*q3))/8 + (Jc*Kb*cos(2*q2 - 2*q3))/8 + (Jc*Kb*cos(2*q2 + 2*q3))/8 - (Kb*Kc*cos(2*q2 - 2*q3))/8 - (Kb*Kc*cos(2*q2 + 2*q3))/8)/((Ib*Id*Id)/4 + (Id*Id*Jb)/4 + (Id*Id*Jc)/2 + (Id*Id*Ka)/2 + (Id*Id*Kb)/4 + (Ib*Ic*Id)/4 + (Ib*Ic*Jb)/2 + (Ib*Ic*Jc)/4 + (Ib*Id*Jb)/2 + (Ib*Id*Jc)/4 + (Ic*Id*Jb)/4 + (Ic*Id*Jc)/2 + (Ib*Ic*Kc)/4 + (Ic*Id*Ka)/2 + (Ic*Jb*Jc)/4 + (Ib*Id*Kc)/4 + (Ic*Id*Kb)/4 + (Id*Jb*Jc)/4 + Ic*Jb*Ka + (Ic*Jb*Kb)/2 + (Ic*Jc*Ka)/2 + Id*Jb*Ka + (Ic*Jb*Kc)/4 + (Ic*Jc*Kb)/4 + (Id*Jb*Kb)/2 + (Id*Jc*Ka)/2 + (Ic*Jc*Kc)/2 + (Id*Jb*Kc)/4 + (Id*Jc*Kb)/4 + (Id*Jc*Kc)/2 + (Ic*Ka*Kc)/2 + (Ic*Kb*Kc)/4 + (Id*Ka*Kc)/2 + (Id*Kb*Kc)/4 - (Ib*Id*Id*cos(2*q2))/4 - (Ib*Id*Id*cos(2*q3))/4 + (Id*Id*Jb*cos(2*q2))/4 + (Id*Id*Jb*cos(2*q3))/4 + (Id*Id*Jc*cos(2*q3))/2 - (Id*Id*Ka*cos(2*q2))/2 - (Id*Id*Kb*cos(2*q2))/4 + (Id*Id*Kb*cos(2*q3))/4 + (Ib*Id*Id*cos(2*q2 - 2*q3))/8 + (Ib*Id*Id*cos(2*q2 + 2*q3))/8 + (Id*Id*Jb*cos(2*q2 - 2*q3))/8 + (Id*Id*Jb*cos(2*q2 + 2*q3))/8 - (Id*Id*Kb*cos(2*q2 - 2*q3))/8 - (Id*Id*Kb*cos(2*q2 + 2*q3))/8 - (Ib*Ic*Id*cos(2*q2))/4 - (Ib*Ic*Id*cos(2*q3))/4 - (Ib*Ic*Jb*cos(2*q3))/2 + (Ib*Ic*Jc*cos(2*q2))/4 - (Ib*Ic*Jc*cos(2*q3))/4 - (Ib*Id*Jb*cos(2*q3))/2 + (Ib*Id*Jc*cos(2*q2))/4 + (Ic*Id*Jb*cos(2*q2))/4 - (Ib*Id*Jc*cos(2*q3))/4 + (Ic*Id*Jb*cos(2*q3))/4 + (Ic*Id*Jc*cos(2*q3))/2 - (Ib*Ic*Kc*cos(2*q2))/4 - (Ic*Id*Ka*cos(2*q2))/2 - (Ic*Jb*Jc*cos(2*q2))/4 - (Ib*Ic*Kc*cos(2*q3))/4 + (Ic*Jb*Jc*cos(2*q3))/4 - (Ib*Id*Kc*cos(2*q2))/4 - (Ic*Id*Kb*cos(2*q2))/4 - (Id*Jb*Jc*cos(2*q2))/4 - (Ib*Id*Kc*cos(2*q3))/4 + (Ic*Id*Kb*cos(2*q3))/4 + (Id*Jb*Jc*cos(2*q3))/4 + (Ic*Jc*Ka*cos(2*q2))/2 + (Ic*Jb*Kb*cos(2*q3))/2 + (Ic*Jb*Kc*cos(2*q2))/4 + (Ic*Jc*Kb*cos(2*q2))/4 + (Id*Jc*Ka*cos(2*q2))/2 + (Ic*Jb*Kc*cos(2*q3))/4 + (Ic*Jc*Kb*cos(2*q3))/4 + (Id*Jb*Kb*cos(2*q3))/2 + (Id*Jb*Kc*cos(2*q2))/4 + (Id*Jc*Kb*cos(2*q2))/4 + (Ic*Jc*Kc*cos(2*q3))/2 + (Id*Jb*Kc*cos(2*q3))/4 + (Id*Jc*Kb*cos(2*q3))/4 + (Id*Jc*Kc*cos(2*q3))/2 - (Ic*Ka*Kc*cos(2*q2))/2 - (Ic*Kb*Kc*cos(2*q2))/4 - (Id*Ka*Kc*cos(2*q2))/2 + (Ic*Kb*Kc*cos(2*q3))/4 - (Id*Kb*Kc*cos(2*q2))/4 + (Id*Kb*Kc*cos(2*q3))/4 + (Ib*Ic*Id*cos(2*q2 - 2*q3))/8 + (Ib*Ic*Id*cos(2*q2 + 2*q3))/8 - (Ib*Ic*Jc*cos(2*q2 - 2*q3))/8 - (Ib*Ic*Jc*cos(2*q2 + 2*q3))/8 - (Ib*Id*Jc*cos(2*q2 - 2*q3))/8 - (Ib*Id*Jc*cos(2*q2 + 2*q3))/8 + (Ic*Id*Jb*cos(2*q2 - 2*q3))/8 + (Ic*Id*Jb*cos(2*q2 + 2*q3))/8 + (Ib*Ic*Kc*cos(2*q2 - 2*q3))/8 + (Ib*Ic*Kc*cos(2*q2 + 2*q3))/8 - (Ic*Jb*Jc*cos(2*q2 - 2*q3))/8 - (Ic*Jb*Jc*cos(2*q2 + 2*q3))/8 + (Ib*Id*Kc*cos(2*q2 - 2*q3))/8 + (Ib*Id*Kc*cos(2*q2 + 2*q3))/8 - (Ic*Id*Kb*cos(2*q2 - 2*q3))/8 - (Ic*Id*Kb*cos(2*q2 + 2*q3))/8 - (Id*Jb*Jc*cos(2*q2 - 2*q3))/8 - (Id*Jb*Jc*cos(2*q2 + 2*q3))/8 + (Ic*Jb*Kc*cos(2*q2 - 2*q3))/8 + (Ic*Jb*Kc*cos(2*q2 + 2*q3))/8 + (Ic*Jc*Kb*cos(2*q2 - 2*q3))/8 + (Ic*Jc*Kb*cos(2*q2 + 2*q3))/8 + (Id*Jb*Kc*cos(2*q2 - 2*q3))/8 + (Id*Jb*Kc*cos(2*q2 + 2*q3))/8 + (Id*Jc*Kb*cos(2*q2 - 2*q3))/8 + (Id*Jc*Kb*cos(2*q2 + 2*q3))/8 - (Ic*Kb*Kc*cos(2*q2 - 2*q3))/8 - (Ic*Kb*Kc*cos(2*q2 + 2*q3))/8 - (Id*Kb*Kc*cos(2*q2 - 2*q3))/8 - (Id*Kb*Kc*cos(2*q2 + 2*q3))/8);
h12 = -(4*Ib*cos(q2) + 4*Id*cos(q2) + 8*Ka*cos(q2) + 4*Kb*cos(q2) + 4*Kc*cos(q2) - 2*Ib*cos(q2 - 2*q3) - 2*Ib*cos(q2 + 2*q3) + 2*Id*cos(q2 - 2*q3) + 2*Id*cos(q2 + 2*q3) + 2*Kb*cos(q2 - 2*q3) + 2*Kb*cos(q2 + 2*q3) + 2*Kc*cos(q2 - 2*q3) + 2*Kc*cos(q2 + 2*q3))/(2*Ib*Id + 4*Ib*Jb + 2*Ib*Jc + 2*Id*Jb + 4*Id*Jc + 2*Ib*Kc + 4*Id*Ka + 2*Jb*Jc + 2*Id*Kb + 8*Jb*Ka + 4*Jb*Kb + 4*Jc*Ka + 2*Jb*Kc + 2*Jc*Kb + 4*Jc*Kc + 4*Ka*Kc + 2*Kb*Kc - 2*Ib*Id*cos(2*q2) - 2*Ib*Id*cos(2*q3) - 4*Ib*Jb*cos(2*q3) + 2*Ib*Jc*cos(2*q2) - 2*Ib*Jc*cos(2*q3) + 2*Id*Jb*cos(2*q2) + 2*Id*Jb*cos(2*q3) + 4*Id*Jc*cos(2*q3) - 2*Ib*Kc*cos(2*q2) - 4*Id*Ka*cos(2*q2) - 2*Jb*Jc*cos(2*q2) - 2*Ib*Kc*cos(2*q3) + 2*Jb*Jc*cos(2*q3) - 2*Id*Kb*cos(2*q2) + 2*Id*Kb*cos(2*q3) + 4*Jc*Ka*cos(2*q2) + 4*Jb*Kb*cos(2*q3) + 2*Jb*Kc*cos(2*q2) + 2*Jc*Kb*cos(2*q2) + 2*Jb*Kc*cos(2*q3) + 2*Jc*Kb*cos(2*q3) + 4*Jc*Kc*cos(2*q3) - 4*Ka*Kc*cos(2*q2) - 2*Kb*Kc*cos(2*q2) + 2*Kb*Kc*cos(2*q3) + Ib*Id*cos(2*q2 - 2*q3) + Ib*Id*cos(2*q2 + 2*q3) - Ib*Jc*cos(2*q2 - 2*q3) - Ib*Jc*cos(2*q2 + 2*q3) + Id*Jb*cos(2*q2 - 2*q3) + Id*Jb*cos(2*q2 + 2*q3) + Ib*Kc*cos(2*q2 - 2*q3) + Ib*Kc*cos(2*q2 + 2*q3) - Jb*Jc*cos(2*q2 - 2*q3) - Jb*Jc*cos(2*q2 + 2*q3) - Id*Kb*cos(2*q2 - 2*q3) - Id*Kb*cos(2*q2 + 2*q3) + Jb*Kc*cos(2*q2 - 2*q3) + Jb*Kc*cos(2*q2 + 2*q3) + Jc*Kb*cos(2*q2 - 2*q3) + Jc*Kb*cos(2*q2 + 2*q3) - Kb*Kc*cos(2*q2 - 2*q3) - Kb*Kc*cos(2*q2 + 2*q3));
h13 = (2*Id*sin(2*q2 - q3)*sin(q3) - 2*Jc*sin(2*q2 - q3)*sin(q3) + 2*Kc*sin(2*q2 - q3)*sin(q3) + 2*Id*sin(2*q2 + q3)*sin(q3) - 2*Jc*sin(2*q2 + q3)*sin(q3) + 2*Kc*sin(2*q2 + q3)*sin(q3))/(4*Ib*Id + 8*Ib*Jb + 4*Ib*Jc + 4*Ib*Kc + 4*Id*Ka + 8*Jb*Ka + 4*Jc*Ka + 4*Ka*Kc - 2*Ib*Id*cos(2*q2) - 4*Ib*Id*cos(q3)*cos(q3) + 2*Ib*Jc*cos(2*q2) + 2*Id*Jb*cos(2*q2) - 8*Ib*Jb*cos(q3)*cos(q3) - 4*Ib*Jc*cos(q3)*cos(q3) + 4*Id*Jb*cos(q3)*cos(q3) + 8*Id*Jc*cos(q3)*cos(q3) - 2*Ib*Kc*cos(2*q2) - 4*Id*Ka*cos(2*q2) - 2*Jb*Jc*cos(2*q2) - 2*Id*Kb*cos(2*q2) - 4*Ib*Kc*cos(q3)*cos(q3) + 4*Jb*Jc*cos(q3)*cos(q3) + 4*Id*Kb*cos(q3)*cos(q3) + 4*Jc*Ka*cos(2*q2) + 2*Jb*Kc*cos(2*q2) + 2*Jc*Kb*cos(2*q2) + 8*Jb*Kb*cos(q3)*cos(q3) + 4*Jb*Kc*cos(q3)*cos(q3) + 4*Jc*Kb*cos(q3)*cos(q3) + 8*Jc*Kc*cos(q3)*cos(q3) - 4*Ka*Kc*cos(2*q2) - 2*Kb*Kc*cos(2*q2) + 4*Kb*Kc*cos(q3)*cos(q3) + Ib*Id*cos(2*q2 - 2*q3) + Ib*Id*cos(2*q2 + 2*q3) - Ib*Jc*cos(2*q2 - 2*q3) - Ib*Jc*cos(2*q2 + 2*q3) + Id*Jb*cos(2*q2 - 2*q3) + Id*Jb*cos(2*q2 + 2*q3) + Ib*Kc*cos(2*q2 - 2*q3) + Ib*Kc*cos(2*q2 + 2*q3) - Jb*Jc*cos(2*q2 - 2*q3) - Jb*Jc*cos(2*q2 + 2*q3) - Id*Kb*cos(2*q2 - 2*q3) - Id*Kb*cos(2*q2 + 2*q3) + Jb*Kc*cos(2*q2 - 2*q3) + Jb*Kc*cos(2*q2 + 2*q3) + Jc*Kb*cos(2*q2 - 2*q3) + Jc*Kb*cos(2*q2 + 2*q3) - Kb*Kc*cos(2*q2 - 2*q3) - Kb*Kc*cos(2*q2 + 2*q3));
h14 = -(cos(q3)*(Id*sin(q2) + Jb*sin(q2) + Kc*sin(q2)))/(Ib*Id + Ib*Jb + Ib*Kc + Id*Ka + Jb*Ka + Ka*Kc - Ib*Id*cos(q2)*cos(q2) - Ib*Id*cos(q3)*cos(q3) - Ib*Jb*cos(q3)*cos(q3) + Ib*Jc*cos(q2)*cos(q2) + Id*Jc*cos(q3)*cos(q3) - Ib*Kc*cos(q2)*cos(q2) - Id*Ka*cos(q2)*cos(q2) - Ib*Kc*cos(q3)*cos(q3) + Jb*Jc*cos(q3)*cos(q3) + Id*Kb*cos(q3)*cos(q3) + Jc*Ka*cos(q2)*cos(q2) + Jb*Kb*cos(q3)*cos(q3) + Jc*Kc*cos(q3)*cos(q3) - Ka*Kc*cos(q2)*cos(q2) + Kb*Kc*cos(q3)*cos(q3) + Ib*Id*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Ib*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Id*Jb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Ib*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Jb*Jc*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Id*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Jb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3) + Jc*Kb*cos(q2)*cos(q2)*cos(q3)*cos(q3) - Kb*Kc*cos(q2)*cos(q2)*cos(q3)*cos(q3));
h15 = (4*Id*sin(q3) + 8*Jb*sin(q3) + 4*Jc*sin(q3) + 4*Kc*sin(q3) - 4*Id*cos(2*q2)*sin(q3) + 4*Jc*cos(2*q2)*sin(q3) - 4*Kc*cos(2*q2)*sin(q3))/(4*Ib*Id + 8*Ib*Jb + 4*Ib*Jc + 4*Ib*Kc + 4*Id*Ka + 8*Jb*Ka + 4*Jc*Ka + 4*Ka*Kc - 2*Ib*Id*cos(2*q2) - 4*Ib*Id*cos(q3)*cos(q3) + 2*Ib*Jc*cos(2*q2) + 2*Id*Jb*cos(2*q2) - 8*Ib*Jb*cos(q3)*cos(q3) - 4*Ib*Jc*cos(q3)*cos(q3) + 4*Id*Jb*cos(q3)*cos(q3) + 8*Id*Jc*cos(q3)*cos(q3) - 2*Ib*Kc*cos(2*q2) - 4*Id*Ka*cos(2*q2) - 2*Jb*Jc*cos(2*q2) - 2*Id*Kb*cos(2*q2) - 4*Ib*Kc*cos(q3)*cos(q3) + 4*Jb*Jc*cos(q3)*cos(q3) + 4*Id*Kb*cos(q3)*cos(q3) + 4*Jc*Ka*cos(2*q2) + 2*Jb*Kc*cos(2*q2) + 2*Jc*Kb*cos(2*q2) + 8*Jb*Kb*cos(q3)*cos(q3) + 4*Jb*Kc*cos(q3)*cos(q3) + 4*Jc*Kb*cos(q3)*cos(q3) + 8*Jc*Kc*cos(q3)*cos(q3) - 4*Ka*Kc*cos(2*q2) - 2*Kb*Kc*cos(2*q2) + 4*Kb*Kc*cos(q3)*cos(q3) + Ib*Id*cos(2*q2 - 2*q3) + Ib*Id*cos(2*q2 + 2*q3) - Ib*Jc*cos(2*q2 - 2*q3) - Ib*Jc*cos(2*q2 + 2*q3) + Id*Jb*cos(2*q2 - 2*q3) + Id*Jb*cos(2*q2 + 2*q3) + Ib*Kc*cos(2*q2 - 2*q3) + Ib*Kc*cos(2*q2 + 2*q3) - Jb*Jc*cos(2*q2 - 2*q3) - Jb*Jc*cos(2*q2 + 2*q3) - Id*Kb*cos(2*q2 - 2*q3) - Id*Kb*cos(2*q2 + 2*q3) + Jb*Kc*cos(2*q2 - 2*q3) + Jb*Kc*cos(2*q2 + 2*q3) + Jc*Kb*cos(2*q2 - 2*q3) + Jc*Kb*cos(2*q2 + 2*q3) - Kb*Kc*cos(2*q2 - 2*q3) - Kb*Kc*cos(2*q2 + 2*q3));

A = [ 0  0  0  1  0 ; 
      0  0  0  0  1 ;
      0  0 h1 h2 h3 ;
      0  0 h4 h5 h6 ; 
      0  0 h7 h8 h9 ];
  
B = [ 0   0   ;
      0   0   ;
      h10 h11 ;
      h12 h13 ;
      h14 h15 ];
  

C = [1 0 0 0 0; 0 1 0 0 0];
D = zeros(2);

G = ss(A,B,C,D);

G.OutputName={'q3','q4'};
G.InputName={'T1','T2'};
G.StateName={'q3','q4','w2','w3','w4'};